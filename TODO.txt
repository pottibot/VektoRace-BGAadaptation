CURRENT TODO (IN ORDER OF IMPORTANCE):
- test zombieTurn() in all states
- tooltips:
  - cars and marker -> move car elements to map oversurface (to be able to catch pointer event)
  - selection octagon (?)

BUG and FIXES:
- better zoom interval
- lock preveiw for orientation too
- reduce controls of curve progression (since a new offtrack system is implemented)
- implement confirmation for initial positioning phases
- stop mouse wheel on interactable elements
- [t] add precheck for move confirmation (code ugly and bad)
- [t] check use of boost to enter pitstop
- [t] predict tire token amount when giving a tire (gear vec) position as the only option for a player
- [t] rare error in player order due to curve progression
  - [v] to fix curve progression: curve is not passed until next curve zone is 0-4 
  - does this fix also wrong assignment of turn position (NO, but it probably makes it even more rare)
- [t] add word 'gear' after ordinal number in notification for when text is not substituted with icon
- [t] substitute lock selector with preview lock in ajax wrapper
  - remove excess previews lock
- fine tune margin error and curbs coordinate
- [v] test zombie car removal after new fix (also: can a zombie come back into the game?)
  - zombie still produce errors (where, when, how?)
- add tooltip to pitstop
- [v] fix postgame replay -> check that substitution still works. how to handle taranslation of unsubstituted string?
- [v] find way to know which curb is next in nonstandard layouts
- [v] fix notif mess with substitution
- [t] previews should be displayed above every game element
- [t] desaturated preview vector
- attack moves displays only if player behind botton (no move can be valid else)
- firefox cutting sprites not pretty
- markup in tooltips (?)
- translation tire tokens or tire points
- player can cross finish line diagonally (cannot check for direction after without preventing rotation after)
- gear vector not being destroyed after animation end (happens only if browser is not active, only chrome? fixed?)
- dropshadow make safari crash? (doesn't seem like, but map not loading instead)

ADDITIONAL FEATURES:
- for mobile: first click triggers hover, second (if preview is at clicked location) triggers real click and sends move to server
- add limits to alternative track layouts
- voluntary penality when emergency braking (or check that vector doesn't go -1 curve zone during emergency downshift)
- [v] add lable indicating number of laps and circuit type
- [v] boost confirm button
- [v] icons in log
- wider first positioning area
- circuit layout combinations for different laps -> highlight track layout on bottom left of map for each player 
- change cursor for moves not allowed
- better notification for no attack reason
- more and better tooltips
- add statistics resources left
- add statistic initial positition
- add background
- endgame race replay
- custom initial order (for tournaments and consecutive games)
- tournament based on thinking time?
- scroll map to new events option?
- offtrack penality?
- volountary penality?
- emergency brake visuals that show each invalid vector?

POSSIBLE CODE RESTRUCT:
- could move offtrack check and other position validity checks on action handler. position will seem valid in UI but server will throw exception.
  this makes arg method simpler and also UI less confusing on why certain position are not valid. only blocked position will be those colliding and those denied by shunk
- unified skip action?
- car pos legal checks overhaul(?)
- token selection auto fill redo(?)

NEW UPDATE NOTE:

New update has been uploaded with a bunch of improvements:
- new map! designers decided to modify the map slightly to improve the tracks design and accomodate the bga implementation
- preferences overhaul: now preferences are available in the standard preferences drawer of the bga interface and should persist through page reloads and multiple games
- changed preference "track guides" to "track boundaries" which are less invasive and more helpful in indicating the actual valid path of the track. this is now set to yes by default
- added preference "move confirmation" which adds a confirm button to trigger the action of placing a gear or boost vector, choosing the rotation of the car and the starting position at the beginning of the race. this should help avoiding misclicks, especially on mobile for which this preference is set to yes by default.
- removed game option "map boundaries". as mentioned in a previous comment, it didn't really made sense. now it is always set to "center of mass" which means that boundary is crossed if center of object (car or vector) is beyond its limit.
- added enforcement of track boundaries. now the player is not allowed to go offtrack (center of car cannot cross red dashed lines). before, the system would only check for the player passing the curve from behind.
- added statistic for starting position. this will be complemented with a special game option to let players decide a custom starting order for the game, which can be used to guarantee players along multiple games a more fair distribution of the advantage of starting in the first positions.
- fixed error on curve progression (emergency brake preventing any position)
- fixed error on tire spending prediction
- fixed error on computing player turn order
- fixed error on pit box entrance with boost

next update i will try to fix system that handles quitting players, which still seems to fail in certain scenarios

let me know if everything works as intended!